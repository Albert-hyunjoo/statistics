# 유의성 검정

> 어떠한 **통계적 관측 결과**가 도출되었을 때, 그 것이 **통계적으로 유의**한지 어떻게 검사하는가?    
> 표본의 특성에 따라 어떤 유의성 검정을 사용해야 하는가? (t-검정, z-검정)

## 가설검정의 원리
* 통계학자들은 `유의성 검정`을 통해 특정 사건이 *우연*인지, *중요한지*를 판단한다.
* 어떠한 통계량이 그 기대값을 기준으로 **표준편차 2단위** 이상 떨어져있으면, 이는 우연이라 보기 힘들다.
* `유의성 검정`의 기본 원리는 `귀류법`으로, 일단 가정 후 이에 대한 **모순을 밝혀내는 식**으로 진행
> ex)    
> 한 국회의원이 새로운 세금 정책을 제시했다고 가정한다.
> 국회의원의 주장으로는 이 정책적 변화가 세수에 아무런 영향을 끼치지 못할 것이라고 했으나,
> 이를 통계적으로 제시하지는 않았다.    
> 이를 위해서 국세청은 **10만 개**의 모집단에서 **100개**의 표본을 추출하였고, 그 결과 정책 적용 전후의 세수
> 차이는 *-21만 9천원*이고, 그 표본의 표준편차는 *73만원*이다. 유의성 검정을 실시하라.  
> 
> Answer)    
> [주의] 기본적으로 이 문제는 '모집단' 대상이다.    
> 즉, 모집단과 표본평균의 비교가 필요하다. (-> 표준오차의 사용)
> 
> 일단 기본적으로 얻은 값은 표본평균이므로 (21만 9천원) 표본평균의 표준오차를 확인한다.    
> > 표본평균의 표준오차: 73만원 / √100 = *7만 3천원*    
> 
> 귀무가설은 차이는 0원이고, 표본 평균은 -21만 9000원, 그리고 표준오차는 7만 3천원이므로
> 통계적인 검정을 위해서 이에 대한 유의성 검정을 실시한다.
> > z-value = (-21만 9000원 - 0) / 7만 3000원 = -3    
> 
> 기본적으로 충분한 표본을 뽑았으므로 *정규분포*를 이용할 수 있다는 가정하에,     
> 이 z-value는 기대값과 비교해서 자그마치 3표준편차 정도나 떨어져 있으므로 **귀무가설은 기각된다.**

## 귀무가설과 대립가설
* `귀무가설`은 관측된 차이가 단순히 **우연의 산물**이라고 생각한다는 주장이고,    
  `대립가설`은 관측된 차이가 **통계적으로 중요**한 실질적 관측 결과라는 주장에 해당한다.

## 검정통계량과 유의수준
* `검정통계량`은 자료에서 얻은 `통계치`와 `귀무가설의 기댓값의 차이`를 `표준화`한 값이다.
* 보통 충분한 자료가 있다는 전제하에 행하는 z-검정에서 쓰이는 검정통계량은 `z-값`이라고 한다.
* z-검정에서 `표준정규분포` 하의 면적, 즉 기각역은 `p-value (p-값)`이라고 한다.
* `p-value`는 자료에 의지하며, 이또한 *관측된 유의수준*에 해당한다.    
= `p-value`는 지금 관측한 값보다 **더 극단적인 값**을 얻을 확률에 해당한다.    
* 단, `유의수준`에 따라서 `p-value`에 기반한 결정 결과는 달라진다 (5%? 10%)

### 단측검정과 양측검정
* `단측검정`은 **우측**이면 *mu > mu0*, **좌측**이면 *mu < mu0*
* `양측검정`은 *mu = mu0*이거나, *mu ≠ mu0* 이거나

## 제1종 오류와 제2종 오류
* 충분한 `검정력`이 있어야 올바른 결정을 내릴 수 있다.
* 오류에는 `제 1종 오류`와 `제 2종 오류`가 존재하는데,
    * `제 1종 오류`는 귀무가설을 *기각하지 말아야* 함에도 *기각*하는 경우
    * `제 2종 오류`는 귀무가설을 *기각해야 함*에도 *기각하지 않는* 경우

## 유의성의 검정 절차
> **[유의성의 검정 절차]**    
> 1. 자료를 설명하기 위한 상자모형을 만들고 귀무가설을 생성
> 2. 유의수준 alpha를 정한다.
> 3. 일단 귀무가설이 맞다고 치고, 기대값을 계산한다.
> 4. 관측치와 기대값의 차이를 측정할 검정통계량의 값을 구한다.
> 5. 관측된 유의수준인 p-값을 계산한다.
> 6. p-값과 유의수준 alpha를 비교한다.

* `검정통계량`은 상황마다 다르게 되며, 그 종류는 매우 다양하다 (*t, 복수-z, x^2...*)
* `귀무가설`에서 비롯된 기댓값과 검정통계량이 통상 `2표준편차` 이상 넘어가면, 이는 귀무가설 기각 사유이다.
* 일반적으로 많이 사용하는 유의수준은 alpha = **5%** (*z5% = 1.65*), **1%** (*z1% = 2.33*), **2.5%** (*z2.5% = 1.96*)

## 성공/실패의 구분: 표본이 많은 경우
> Q.    
> 어떤 사람이 100일간의 주가 등락 여부를 65일 맞췄다.    
> 통계학적으로 따지고 보았을 때, 이는 단순한 우연인가? 통계적 유의성이 있는가?
* 표본이 100개 이상으로 충분한 경우, 통상적으로 `z-검정`을 시행한다.
* 여기서 모집단은 0, 1로 쓰인 카드가 1개 씩밖에 없는 상자이다.
* 우리가 파악하려는 포인트는 이 사람의 *전반적 주가 예측 능력*이지, 100일간의 *주가 예측 능력*이 아니다.    
즉, 여기서 쓰이는 검정통계량 상의 표준편차는 *표준오차로 판단*되어야 한다.    
* 통상적으로 기댓값은 0.5, 즉 50개가 기대치이므로 다음과 같은 식을 통해 `z-값`을 구한다.
> 65 (관측치) - 50 (기댓값) / √100 * 0.5 (제곱근법칙) = 3 (3표준편차)    
= 3보다 극단적인 확률은 매우 작으므로, 이는 **우연이라고 볼 수는 없다.**    
> (참고로 0, 1 중에 하나를 뽑는 것이므로 *상자의 표준편차*는 √(1 * 0.5*0.5))

## 성공/실패의 구분: 표본이 적은 경우
> Q.    
> 세익이와 화령이는 대학교 신입생으로, 세익이는 2번 신청에 1번 꼴로 데이트를 한다.   
> 근데 최근에 9번 연락해서 1번 꼴로 데이트를 하게 되었다. 사랑이 식은건가?

* 기본적으로 9번이라는 표본은 너무나 적으므로, 다른 방법을 찾아야 한다.
* 귀무가설 (사랑은 안변함) 하에서 각 시행은 성공확률이 1/2인 *베르누이 분포*를 따르므로, **이항공식**을 확용한다.
* 다음과 같은 계산을 통해서 계산을 진행하게 된다.
> 9C0 * (1/2)^9 * (1/2)^0 + 9C1 * (1/2)^8 * (1/2)^! = 10 /512 = 0.02

## t-검정
* 표본크기도 크지 않고, 질적인 자료도 아니면 `t-검정`을 사용한다.
> Q.     
> 정부는 자동차의 과속을 단소하기 위해 주행차량의 속도는 카메라를 운영한다.     
> 5개의 속도측정기에 의거하여 108.0, 113.0, 99.4, 102.0, 116.6이 나왔으며 기준속도는 100이다.

* 여기서 귀무가설은 *`HO`: 속도측정기에 편의는 존재하지 않는다* 이다.
* 이번에도 표본의 수가 너무나도 적으므로 (5개) 이 경우 `z-검정` 대신 `t-검정`을 사용
> 107.8 - 100 / 7.23 / √5 = 3.23
* 여기서는 `t-검정`을 사용하므로 정규분포곡선 대신 `t-분포`를 사용한다.
* `t-분포`는 자유도에 비례해서 모양이 달라지며, 자유도가 높아질 수록 `표분정규분포`에 가까워진다.
* 요약하면, `t-분포곡선`은 *상자 안 숫자가 정규분포*를 따르며, *표본표준편차*를 사용하며, *표본크기가 작을 때* 쓴다.